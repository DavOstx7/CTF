I went over the code, and realized that the solution was pretty simple.
The code itself was pretty weird
I saw that if you give the read_data function input which is not a number, it will quit and give the flag.
In order to use the read_data function, you have to first give input
# I started by entering the '1' option, then I gave the data 'abc' and then the length of '3' (I didn't check what happens if you give wrong length - maybe another way to get to the flag)
# Then I entereed the '2' option, and gave the data 'abc', and got the flag.